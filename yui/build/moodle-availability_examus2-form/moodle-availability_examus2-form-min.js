YUI.add("moodle-availability_examus2-form",function(de,e){M.availability_examus2=M.availability_examus2||{},M.availability_examus2.form=de.Object(M.core_availability.plugin),M.availability_examus2.form.rules=null,M.availability_examus2.form.initInner=function(e,a,n,i){this.rules=e,this.warnings=a,this.scoring=n,this.defaults=i},M.availability_examus2.form.instId=0,M.availability_examus2.form.getNode=function(e){var a,t,n,i,l,o,s,r,d,c,u,m,p,b,f,h,v,_,g,y,k,w,x,A,P,q,F,C,N,S,T,E,L,I,O,R,j,J,V,D,H,$,z,B,U,Y,G,K,Q,W,X,Z,ee,ae,ne;function ie(e,a){return a=a||"availability_examus2",M.util.get_string(e,a)}function te(e){var a=ie("showmore","core_form"),n=ie("showless","core_form");return'<a href="#" class="examus2-moreless" data-more="'+a+'" data-less="'+n+'">'+a+'</a><div class="hidden col-md-12">'+e+"</div>"}function le(e,a,n,i,t){var l=t?10:5,o=t?10:7;return'<span class="availability-group form-group mb-2"><div class="col-md-'+l+' col-form-label d-flex flex-nowrap pb-0 pr-md-0">  <label for="'+e+'">'+a+'</label></div><div class="col-md-'+o+' form-inline align-items-center flex-nowrap felement">'+i+(n?'<a class="btn btn-link p-0 ml-2" role="button" data-container="body" data-toggle="popover" data-placement="right" data-content="<div class=&quot;no-overflow&quot;><p>'+n+'</p></div> " data-html="true" tabindex="0" data-trigger="focus" data-original-title="" title=""><i class="icon fa fa-question-circle text-info fa-fw " title="Справка по использованию" aria-label="Справка по использованию"> </i></a>':"")+"</div></span>"}function oe(e){setTimeout(e,0)}function se(e){1==e?(F.addClass("btn-primary"),F.removeClass("btn-secondary"),C.addClass("btn-secondary"),C.removeClass("btn-primary"),N.removeClass("hidden"),S.addClass("hidden")):(C.addClass("btn-primary"),C.removeClass("btn-secondary"),F.addClass("btn-secondary"),F.removeClass("btn-primary"),N.addClass("hidden"),S.removeClass("hidden"))}for(E in M.availability_examus2.form.instId+=1,o=(i="examus2"+M.availability_examus2.form.instId)+"_mode",s=i+"_schedulingRequired",r=i+"_autoRescheduling",d=i+"_isTrial",c=i+"_identification",u=i+"_customRules",m=i+"_auxCamera",p=i+"_allowmultipledisplays",b=i+"_allowvirtualenvironment",f=i+"_checkidphotoquality",h=i+"_ldb",v=i+"_biometryEnabled",_=i+"_biometrySkipfail",g=i+"_biometryFlow",y=i+"_biometryTheme",k=i+"_userAgreement",w=i+"_webCameraMainView",x=i+"_enabledForbiddenProcesses",A=i+"_desktopAppForbiddenProcesses",P=i+"_enabledAllowedProcesses",q=i+"_desktopAppAllowedProcesses",a=le(l=i+"_duration",ie("duration"),ie("duration_desc"),'<input type="text" name="duration" style="flex-wrap: nowrap;" id="'+l+'" class="form-control">'),a+=le(o,ie("proctoring_mode"),ie("proctoring_mode_desc"),'<select name="mode" id="'+o+'" class="custom-select">  <option value="online">'+ie("online_mode")+'</option>  <option value="identification">'+ie("identification_mode")+'</option>  <option value="offline">'+ie("offline_mode")+'</option>  <option value="auto">'+ie("auto_mode")+"</option></select>"),a+=le(c,ie("identification"),ie("identification_desc"),'<select name="identification" id="'+c+'" class="custom-select">  <option value="passport">'+ie("passport_identification")+'</option>  <option value="face">'+ie("face_identification")+'</option>  <option value="face_and_passport">'+ie("face_passport_identification")+'</option>  <option value="skip">'+ie("skip_identification")+"</option></select>"),a+=le(w,ie("web_camera_main_view"),"",'<select name="webcameramainview" id="'+w+'" class="custom-select">  <option value="front">'+ie("web_camera_main_view_front")+'</option>  <option value="side">'+ie("web_camera_main_view_side")+"</option></select>"),a+=le(s,ie("scheduling_required"),ie("scheduling_required_desc"),'<input type="checkbox" name="scheduling_required" id="'+s+'" value="1">&nbsp;<label for="'+s+'">'+ie("enable")+"</label> "),a+=le(r,ie("auto_rescheduling"),ie("auto_rescheduling_desc"),'<input type="checkbox" name="auto_rescheduling" id="'+r+'" value="1">&nbsp;<label for="'+r+'">'+ie("enable")+"</label> "),a+=le(d,ie("is_trial"),ie("is_trial_desc"),'<input type="checkbox" name="istrial" id="'+d+'" value="1">&nbsp;<label for="'+d+'">'+ie("enable")+"</label> "),a+=le(m,ie("auxiliary_camera"),ie("auxiliary_camera_desc"),'<input type="checkbox" name="auxiliarycamera" id="'+m+'" value="1">&nbsp;<label for="'+m+'">'+ie("enable")+"</label> "),a+=le(h,ie("enable_ldb"),ie("enable_ldb_desc"),'<input type="checkbox" name="ldb" id="'+h+'" value="1">&nbsp;<label for="'+h+'">'+ie("enable")+"</label> "),a+=le(p,ie("allowmultipledisplays"),"",'<input type="checkbox" name="allowmultipledisplays" id="'+p+'" value="1">&nbsp;<label for="'+p+'">'+ie("enable")+"</label> "),a+=le(b,ie("allowvirtualenvironment"),"",'<input type="checkbox" name="allowvirtualenvironment" id="'+b+'" value="1">&nbsp;<label for="'+b+'">'+ie("enable")+"</label> "),a+=le(f,ie("checkidphotoquality"),"",'<input type="checkbox" name="checkidphotoquality" id="'+f+'" value="1">&nbsp;<label for="'+f+'">'+ie("enable")+"</label> "),a+=le(k,ie("user_agreement_url"),ie("user_agreement_url_desc"),'<input name="useragreementurl" id="'+k+'" class="form-control" value="" />'),a+=le(u,ie("custom_rules"),ie("custom_rules_desc"),'<textarea name="customrules" id="'+u+'" class="form-control"></textarea>'),a+=le(x,ie("enabledForbiddenProcesses"),"",'<input type="checkbox" name="enabledForbiddenProcesses" id="'+x+'" value="0">&nbsp;<label for="'+x+'">'+ie("enable")+"</label> "),a+=le(A,ie("desktop_app_forbidden_processes"),ie("desktop_app_forbidden_processes_desc"),'<textarea name="desktopAppForbiddenProcesses" id="'+A+'" class="form-control"></textarea>'),a+=le(P,ie("enabledAllowedProcesses"),"",'<input type="checkbox" name="enabledAllowedProcesses" id="'+P+'" value="0">&nbsp;<label for="'+P+'">'+ie("enable")+"</label> "),a+=le(q,ie("desktop_app_allowed_processes"),ie("desktop_app_allowed_processes_desc"),
'<textarea name="desktopAppAllowedProcesses" id="'+q+'" class="form-control"></textarea>'),T="",this.rules)T+='<div style="display:flex;gap:4px;margin-bottom:4px;"><input type="checkbox" name="'+E+'" id="'+(L=i+"_"+E)+'" value="'+E+'" >&nbsp;',T+='<label for="'+L+'" style="white-space: break-spaces">'+ie(E)+"</label></div>";for(O in a+=le(null,ie("rules"),ie("rules_desc"),'<div class="rules" style="white-space:nowrap">'+T+"</div>"),I="",this.warnings)I+='<div style="display:flex;gap:4px;margin-bottom:4px;"><input type="checkbox" name="'+O+'" id="'+(R=i+"_"+O)+'" value="'+O+'" >&nbsp;',I+='<label for="'+R+'" style="white-space: break-spaces">'+ie(O)+"</label></div>";for(J in j="",this.scoring)D='<input type="number" class="examus2-scoring-input" value=""step="0.01" name="'+J+'"id="scoring_'+(V=i+"_"+J)+'"min="'+this.scoring[J].min+'" max="'+this.scoring[J].max+'">',j+=le(V,ie("scoring_"+J),"",D);if(H="",H+=le(v,ie("biometry_enabled"),"",'<input type="checkbox" name="biometryenabled" id="'+v+'" value="1">&nbsp;<label for="'+v+'">'+ie("enable")+"</label> "),H+=le(_,ie("biometry_skipfail"),"",'<input type="checkbox" name="biometryskipfail" id="'+_+'" value="1">&nbsp;<label for="'+_+'">'+ie("enable")+"</label> "),H+=le(g,ie("biometry_flow"),"",'<input type="text" name="biometryflow" id="'+g+'" class="form-control">'),H+=le(y,ie("biometry_theme"),"",'<input type="text" name="biometrytheme" id="'+y+'" class="form-control">'),$="",$+=le(null,ie("visible_warnings"),ie("visible_warnings_desc"),'<div class="warnings" style="white-space: nowrap" >'+te(I)+"</div>",!0),$+=le(null,ie("scoring_params_header"),ie("scoring_params_header_desc"),te(j),!0),$+=le(null,ie("biometry_header"),"",te(H),!0),(t=de.Node.create('<span class="availability_examus2-tabs" style="position:relative"></span>')).setHTML("<label><strong>"+ie("title")+"</strong></label><br><br>"),z=de.Node.create('<div style="position:absolute; top: 0; right: 0;" class="availability_examus2-tab-btns"></div>').appendTo(t),F=de.Node.create('<a href="#" class="btn btn-primary">1</a>').appendTo(z),C=de.Node.create('<a href="#" class="btn btn-secondary">2</a>').appendTo(z),N=de.Node.create('<div class="tab_content">'+a+"</div>").appendTo(t),S=de.Node.create('<div class="tab_content hidden">'+$+"</div>").appendTo(t),e.rules===undefined&&(e.rules=this.rules),e.warnings===undefined&&(e.warnings=this.warnings),e.scoring=e.scoring||{},e.creating){for(B in this.defaults)if(U=this.defaults[B],"scoring"==B)for(Y in U)e.scoring[Y]=U[Y]?parseFloat(U[Y]):null;else if("rules"==B)for(G in U)e.rules[G]=U[G];else if("warnings"==B)for(K in U)e.warnings[K]=!!U[K];else e[B]=U;e.mode||(e.mode="online",e.scheduling_required=!0)}for(Q in e.duration!==undefined&&t.one("input[name=duration]").set("value",e.duration),e.mode!==undefined&&t.one("select[name=mode] option[value="+e.mode+"]").set("selected","selected"),e.identification!==undefined&&t.one("select[name=identification] option[value="+e.identification+"]").set("selected","selected"),e.webcameramainview&&t.one("select[name=webcameramainview] option[value="+e.webcameramainview+"]").set("selected","selected"),e.auto_rescheduling!==undefined&&t.one("#"+r).set("checked",e.auto_rescheduling?"checked":null),e.istrial!==undefined&&(n=e.istrial?"checked":null,t.one("#"+d).set("checked",n)),e.auxiliarycamera!==undefined&&t.one("#"+m).set("checked",e.auxiliarycamera?"checked":null),e.ldb!==undefined&&t.one("#"+h).set("checked",e.ldb?"checked":null),e.scheduling_required!==undefined&&t.one("#"+s).set("checked",e.scheduling_required?"checked":null),e.allowmultipledisplays!==undefined&&t.one("#"+p).set("checked",e.allowmultipledisplays?"checked":null),e.allowvirtualenvironment!==undefined&&t.one("#"+b).set("checked",e.allowvirtualenvironment?"checked":null),e.checkidphotoquality!==undefined&&t.one("#"+f).set("checked",e.checkidphotoquality?"checked":null),e.biometryenabled!==undefined&&t.one("#"+v).set("checked",e.biometryenabled?"checked":null),e.biometryskipfail!==undefined&&t.one("#"+_).set("checked",e.biometryskipfail?"checked":null),e.biometryflow!==undefined&&t.one("#"+g).set("value",e.biometryflow),e.biometrytheme!==undefined&&t.one("#"+y).set("value",e.biometrytheme),this.warnings)e.warnings[Q]===undefined&&(e.warnings[Q]=this.warnings[Q]);for(W in e.warnings)e.warnings[W]&&(X=t.one(".warnings input[name="+W+"]"))&&X.set("checked","checked");for(Z in e.rules)e.rules[Z]&&(ee=t.one(".rules input[name="+Z+"]"))&&ee.set("checked","checked");for(ae in e.scoring)isNaN(e.scoring[ae])||(ne=t.one(".examus2-scoring-input[name="+ae+"]"))&&ne.set("value",e.scoring[ae]);if(e.customrules!==undefined&&t.one("#"+u).set("value",e.customrules),e.enabledForbiddenProcesses!==undefined&&t.one("#"+x).set("checked",e.enabledForbiddenProcesses?"checked":null),e.desktopAppForbiddenProcesses!==undefined){try{t.one("#"+A).set("value",JSON.parse(e.desktopAppForbiddenProcesses).join("\n"))}catch(re){t.one("#"+A).set("value",e.desktopAppForbiddenProcesses)}t.one("#"+A).set("disabled",t.one("#"+x).get("checked")?null:"disabled")}if(e.enabledAllowedProcesses!==undefined&&t.one("#"+P).set("checked",e.enabledAllowedProcesses?"checked":null),e.desktopAppAllowedProcesses!==undefined){try{t.one("#"+q).set("value",JSON.parse(e.desktopAppAllowedProcesses).join("\n"))}catch(re){t.one("#"+q).set("value",e.desktopAppAllowedProcesses)}t.one("#"+q).set("disabled",t.one("#"+P).get("checked")?null:"disabled")}return e.useragreementurl!==undefined&&t.one("#"+k).set("value",e.useragreementurl),t.delegate("valuechange",function(){oe(function(){M.core_availability.form.update()})},"input,textarea,select"),t.delegate("click",function(){oe(function(){M.core_availability.form.update()})},"input[type=checkbox]"),t.delegate("valuechange",function(){!function i(){var e=["online","identification"],a=t.one("select[name=mode]").get("value").trim(),n=0<=e.indexOf(a);t.one("#"+s).set("checked",n)}()},"#"+o),F.on("click",function(e){e.preventDefault(),se(1)}),C.on("click",
function(e){e.preventDefault(),se(2)}),t.delegate("click",function(e){e.preventDefault(),function i(e){var a=e.next(),n=a.hasClass("hidden");n?(a.removeClass("hidden"),e.setContent(e.getAttribute("data-less"))):(a.addClass("hidden"),e.setContent(e.getAttribute("data-more")))}(e.target)},".examus2-moreless"),t},M.availability_examus2.form.fillValue=function(n,e){var a,i,t,l;n.duration=e.one("input[name=duration]").get("value").trim(),n.mode=e.one("select[name=mode]").get("value").trim(),n.identification=e.one("select[name=identification]").get("value").trim(),n.webcameramainview=e.one("select[name=webcameramainview]").get("value").trim(),n.auto_rescheduling=e.one("input[name=auto_rescheduling]").get("checked"),n.scheduling_required=e.one("input[name=scheduling_required]").get("checked"),n.istrial=e.one("input[name=istrial]").get("checked"),n.customrules=e.one("textarea[name=customrules]").get("value").trim(),n.enabledForbiddenProcesses=e.one("input[name=enabledForbiddenProcesses]").get("checked"),n.desktopAppForbiddenProcesses=JSON.stringify(e.one("textarea[name=desktopAppForbiddenProcesses]").get("value").split("\n").filter(function(e){return e.trim()})),n.enabledAllowedProcesses=e.one("input[name=enabledAllowedProcesses]").get("checked"),n.desktopAppAllowedProcesses=JSON.stringify(e.one("textarea[name=desktopAppAllowedProcesses]").get("value").split("\n").filter(function(e){return e.trim()})),n.useragreementurl=e.one("input[name=useragreementurl]").get("value").trim(),n.auxiliarycamera=e.one("input[name=auxiliarycamera]").get("checked"),n.ldb=e.one("input[name=ldb]").get("checked"),n.allowmultipledisplays=e.one("input[name=allowmultipledisplays]").get("checked"),n.allowvirtualenvironment=e.one("input[name=allowvirtualenvironment]").get("checked"),n.checkidphotoquality=e.one("input[name=checkidphotoquality]").get("checked"),n.biometryenabled=e.one("input[name=biometryenabled]").get("checked"),n.biometryskipfail=e.one("input[name=biometryskipfail]").get("checked"),n.biometryflow=e.one("input[name=biometryflow]").get("value").trim(),n.biometrytheme=e.one("input[name=biometrytheme]").get("value").trim(),n.rules={},a=e.all(".rules input"),de.each(a,function(e){l=e.get("value"),!0===e.get("checked")?n.rules[l]=!0:n.rules[l]=!1}),document.addEventListener("click",function(e){"enabledForbiddenProcesses"==e.target.name&&(e.target.checked?document.querySelector("textarea[name=desktopAppForbiddenProcesses]").disabled=!1:document.querySelector("textarea[name=desktopAppForbiddenProcesses]").disabled="disabled"),"enabledAllowedProcesses"==e.target.name&&(e.target.checked?document.querySelector("textarea[name=desktopAppAllowedProcesses]").disabled=!1:document.querySelector("textarea[name=desktopAppAllowedProcesses]").disabled="disabled")}),n.warnings={},i=e.all(".warnings input"),de.each(i,function(e){l=e.get("value"),!0===e.get("checked")?n.warnings[l]=!0:n.warnings[l]=!1}),n.scoring={},t=e.all(".examus2-scoring-input"),de.each(t,function(e){l=e.get("name");var a=e.get("value").trim();0<a.length?n.scoring[l]=parseFloat(a):n.scoring[l]=null})},M.availability_examus2.form.fillErrors=function(e,a){var n,i,t,l={};this.fillValue(l,a),n=document.getElementById("duration_error"),l.duration!==undefined&&new RegExp("^\\d+$").test(l.duration)&&l.duration%30==0||n?l.duration!==undefined&&new RegExp("^\\d+$").test(l.duration)&&l.duration%30==0&&n&&n.remove():(i=a._node.querySelector('input[name="duration"]').parentNode.parentNode,(t=document.createElement("span")).style.color="red",t.style.fontSize="11px",t.innerHTML=M.util.get_string("error_setduration","availability_examus2"),t.classList.add("col-md-10"),t.classList.add("col-form-label"),t.classList.add("d-flex"),t.classList.add("mb-1"),t.classList.add("pt-0"),t.id="duration_error",i.insertAdjacentElement("afterend",t))}},"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});